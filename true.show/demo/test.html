<!DOCTYPE html>
<html>
  <head>
	<meta charset="UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="renderer" content="webkit">
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=10, user-scalable=yes">
	<meta name="description" content="">
	<meta name="keywords" content="">
	<title>PPT Marker</title>
	<link rel="stylesheet" type="text/css" href="asset/css/reset.css">
	<link rel="stylesheet" type="text/css" href="asset/css/font-awesome-4.4.0/css/font-awesome.min.css">
	<link rel="stylesheet" type="text/css" href="asset/css/app.css">
	<link rel="stylesheet" type="text/css" href="asset/css/animate.css">
	</head>
	<body>
	<!-- <div id="tips" class="tips-right" style="left:100px;top: 100px;visibility:visible;">122</div>
		<input type="button" value="读取剪贴板内容" onclick="readClipboardData();" />
    <br /> <textarea rows="20" cols="60" id="txtContent"></textarea> -->
	</body>
	<script type="text/javascript">
      function getClipboard() {
          if (window.clipboardData) {
              return (window.clipboardData.getData('Text'));
          }
          else if (window.netscape) {
              netscape.security.PrivilegeManager.enablePrivilege('UniversalXPConnect');
              var clip = Components.classes['@mozilla.org/widget/clipboard;1'].createInstance(Components.interfaces.nsIClipboard);
              if (!clip) return;
              var trans = Components.classes['@mozilla.org/widget/transferable;1'].createInstance(Components.interfaces.nsITransferable);
              if (!trans) return;
              trans.addDataFlavor('text/unicode');
              clip.getData(trans, clip.kGlobalClipboard);
              var str = new Object();
              var len = new Object();
              try {
                  trans.getTransferData('text/unicode', str, len);
              }
              catch (error) {
                  return null;
              }
              if (str) {
                  if (Components.interfaces.nsISupportsWString) str = str.value.QueryInterface(Components.interfaces.nsISupportsWString);
                  else if (Components.interfaces.nsISupportsString) str = str.value.QueryInterface(Components.interfaces.nsISupportsString);
                  else str = null;
              }
              if (str) {  return (str.data.substring(0, len.value / 2));
              }
          }
          return null;
      }
      function readClipboardData() {
          var str = getClipboard();
          console.log(str);
          var len = str.split("\n");//获取行数
						document.getElementById("txtContent").value = str;
      }

      window.onload = function () {
        var c = document.createElement('canvas');
        c.width = 300;
        c.height = 300;
        document.body.appendChild(c);
        var ctx = c.getContext('2d');
        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(100, 4);
        ctx.lineTo(100, 300);
        ctx.stroke();

        ctx.lineWidth = 1;
        ctx.beginPath();
        ctx.moveTo(150.5, 4);
        ctx.lineTo(150.5, 300);
        ctx.stroke();

        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(200, 4);
        ctx.lineTo(200, 300);
        ctx.stroke();

        ctx.lineWidth = 2;
        ctx.beginPath();
        ctx.moveTo(250.5, 4);
        ctx.lineTo(250.5, 300);
        ctx.stroke();
      };
	</script>
</html>